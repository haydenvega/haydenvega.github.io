<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-03-13">
<meta name="description" content="Learning the art of data science">

<title>Hayden Vega - visualizing the past, present, and predictions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KTFM8KEX8J"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KTFM8KEX8J', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html">
 <span class="menu-text">research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html">
 <span class="menu-text">outreach</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../fieldwork.html">
 <span class="menu-text">fieldwork</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../words.html">
 <span class="menu-text">words</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv_hv.pdf">
 <span class="menu-text">cv</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/haydenvega"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#killing-two-birds-with-one-class" id="toc-killing-two-birds-with-one-class" class="nav-link active" data-scroll-target="#killing-two-birds-with-one-class">Killing two birds with one class</a></li>
  <li><a href="#some-context-about-functional-traits" id="toc-some-context-about-functional-traits" class="nav-link" data-scroll-target="#some-context-about-functional-traits">Some context about FUNctional traits</a></li>
  <li><a href="#the-plot-thickens" id="toc-the-plot-thickens" class="nav-link" data-scroll-target="#the-plot-thickens">The plot thickens</a></li>
  <li><a href="#concluding-a-story" id="toc-concluding-a-story" class="nav-link" data-scroll-target="#concluding-a-story">Concluding a story</a></li>
  <li><a href="#figure-code" id="toc-figure-code" class="nav-link" data-scroll-target="#figure-code">Figure Code</a>
  <ul class="collapse">
  <li><a href="#setting-up-the-models" id="toc-setting-up-the-models" class="nav-link" data-scroll-target="#setting-up-the-models">Setting up the models!</a></li>
  <li><a href="#plot-highlighting-11-relationships" id="toc-plot-highlighting-11-relationships" class="nav-link" data-scroll-target="#plot-highlighting-11-relationships">Plot highlighting 1:1 relationships</a></li>
  <li><a href="#plot-highlighting-deviations-from-a-11-relationship" id="toc-plot-highlighting-deviations-from-a-11-relationship" class="nav-link" data-scroll-target="#plot-highlighting-deviations-from-a-11-relationship">Plot highlighting deviations from a 1:1 relationship</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">visualizing the past, present, and predictions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    Learning the art of data science
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 13, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>TL;DR</strong> I recently took my first data visualization class. Until now, I’d only known data visualization as something sterile-centered around numbers and packed with as many data points as a journal would realistically publish. I thought good data visualizations were only found in research papers, but I’ve realized that good data visualizations (often the best) live inside a world that is just as much art as it is science. Below is my first crack at using the art of data visualization to conceptualize some of my seaweed science.</p>
</blockquote>
<section id="killing-two-birds-with-one-class" class="level2">
<h2 class="anchored" data-anchor-id="killing-two-birds-with-one-class">Killing two birds with one class</h2>
<p>I’m probably lying to myself when I say I don’t know how it happens, but I seem to always inundate myself with projects until my mind is waterlogged. I’m constantly behind, so I’ll always jump at an opportunity to kill two birds with one stone-or, in this case, one class. I recently took Environmental Data Science 240: Data Visualization at the Bren School of Environmental Science and Management, taught by <a href="https://samanthacsik.github.io/">Sam Shanny-Csik</a> and teaching assistants <a href="https://annieradams.github.io/">Annie Adams</a> and Sloane Stephenson. The stars could not have aligned better because not only was this an opportunity to learn from a data science icon like Sam (whose open source guides taught me data science principles and website design long before I was her student), but also because it gave me an opportunity to create figures for a paper that I’ve had in the works for over a year.</p>
</section>
<section id="some-context-about-functional-traits" class="level2">
<h2 class="anchored" data-anchor-id="some-context-about-functional-traits">Some context about FUNctional traits</h2>
<p>Before I dive into my data visualization process, here’s some context about the paper I’m creating these data visualizations for. My paper is an extension of a project called <a href="https://haydenvega.github.io/research/2023-pastpresentpredictions/">Past, Present, Predictions: functional approaches to link species to ecosystem function</a>.It builds off the PhD thesis of one of my mentors and another data science icon, <a href="https://an-bui.com/">An Bui</a>. My project explores the idea that we can leverage the large collections of seaweeds that are preserved by museums and universities into long-term data about kelp forests. Many museums and universities have collections of seaweeds that span hundreds of specimens, species, and even years. These collections are used to studying the anatomy of seaweeds, but my project aims to study how these seaweeds functioned within their kelp forest. We can get data about a seaweed’s function by measuring its characteristics like height, width, volume, or thickness. Measurements like these are called <strong>functional traits</strong> and they can give us clues as to how a seaweed contributed to kelp forest functions/characteristics such as photosynthetic rates, wave reduction, and overall mass of seaweed.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="hw-diagram.png" class="lightbox" title="A diagram showing how height and width (common functional traits) are measured on a simulated seaweed specimen" data-gallery="quarto-lightbox-gallery-1"><img src="hw-diagram.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">A diagram showing how height and width (common functional traits) are measured on a simulated seaweed specimen</figcaption><p></p>
</figure>
</div>
<p>What’s unique about <i>preserved</i> seaweed is that they are a snapshot in time, and we can use them as a window to the past of kelp forest function. Using preserved seaweed, we can observe how a kelp forest functioned at a point in time that predates any data we currently have. This is important because we can use our understanding of the past to predict how kelp forests will function in an uncertain future. But using preserved seaweed also presents a unique challenge when using functional traits.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="kelp-pressing.jpg" class="lightbox" title="One of the oldest pressed seaweeds at the UCSB Herbarium. Collected in 1902 by Mary S. Snyder, this specimen is over one hundred years old!" data-gallery="quarto-lightbox-gallery-2"><img src="kelp-pressing.jpg" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">One of the oldest pressed seaweeds at the UCSB Herbarium. Collected in 1902 by Mary S. Snyder, this specimen is over one hundred years old!</figcaption><p></p>
</figure>
</div>
<p>Universities and museums preserve seaweed by flattening specimens and slowly drying them out. During the process, the seaweeds shrink. This poses a challenge to a functional trait approach because our measurements are now biased by the preservation process. A seaweed with a height of 16 inches when it was initially collected may measure 8 inches after it is dried. <strong>My project seeks to overcome this bias by creating models that use the functional traits of a preserved seaweed to predict the functional traits of that same seaweed before it was preserved.</strong> And I will be visualizing these models in my plots below!</p>
</section>
<section id="the-plot-thickens" class="level2">
<h2 class="anchored" data-anchor-id="the-plot-thickens">The plot thickens</h2>
<p>I started this process with two concrete goals for my visualizations: to show that our models vary by trait and to show that our models vary by species. But as I learned and thought more about the purpose of data visualization, I added a third goal: tell a story.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="ugly-viz.png" class="lightbox" title="An example of an early visualization showing all the different models for each treatment. Note that this plot is hard to read and lacks structure and a clear message" data-gallery="quarto-lightbox-gallery-3"><img src="ugly-viz.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">An example of an early visualization showing all the different models for each treatment. Note that this plot is hard to read and lacks structure and a clear message</figcaption><p></p>
</figure>
</div>
<p>I wanted to show linear models, so I started with a line graph, just two axis and a line. This was perfect for showing the models, but there wasn’t a story there. So I turned to embellishments like titles, labels, colors, and typography to add some narrative to my plots. I had an easy time creating titles and labels because I understood their purpose within a narrative. I had a harder time with elements like color and typography. I never even considered them as elements of a story. Even from a purely aesthetic perspective, I didn’t understand them well. I realized I had been neglecting these components not only in my data visualizations, but also in my everyday life. This exercise in data visualization soon became an exercise in intentional design.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><a href="algae shrink1.png" class="lightbox" data-description="A

diagram

quantifying

extent

to

which

a

seaweed

shrinks

during

the

preservation

process

and

that

it

varies

by

species." data-gallery="finalviz"><img src="algae shrink1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p><a href="plot_ir_1s.png" class="lightbox" data-description="A

line

graph

displaying

linear

models

that

predict

initial

functional

trait

measurements

based

on

rehydrated

preserved

seaweed.

The

models

for

height

and

width

are

highlighted

to

show

that

they

closely

follow

a

1:1

relationship

between

initial

and

rehydrated

measurements" data-gallery="finalviz"><img src="plot_ir_1s.png" class="img-fluid"></a> <a href="plot_ir_deviants.png" class="lightbox" data-description="A

line

graph

displaying

linear

models

that

predict

initial

functional

trait

measurements

based

on

rehydrated

preserved

seaweed.

The

models

for

perimeter,

volume,

and

surface

area

are

highlighted

to

show

that

they

do

not

follow

a

1:1

relationship

between

initial

and

rehydrated

measurements.

This

suggests

that

predictive

models

are

unique

to

each

trait." data-gallery="finalviz"><img src="plot_ir_deviants.png" class="img-fluid"></a></p>
</div>
</div>
</div>
<p>When thinking about the design of my plots, I started with the titles and subtitles. My goal was that they would give the reader the main takeaways from the plot. Data visualization is a complex language in itself. Putting my main takeaways in the titles helps the reader walk away with the main idea without even having to decipher the plot. As a result, my titles are broad and say something about the nature of the relationships shown (vary by species or follow a 1:1 line). Further specificity is available for readers in the plot. There I targeted multiple visual hierarchies to help the reader interpret the data from different angles, and I used embellishments like color and drawings to give the readers access to further complexity. Basic themes were used to minimize non-data ink and to draw attention to just the data being shown. An example where these elements were incorporated is in the shrinkage plot.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="algae shrink1.png" class="lightbox" data-description="My

favorite

viz

and

a

diagram

quantifying

extent

to

which

a

seaweed

shrinks

during

the

preservation

process

and

that

it

varies

by

species." data-gallery="finalviz"><img src="algae shrink1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>In this plot, the main takeaway is that the preservation process changes each species differently, suggesting that some models may need to be species-dependent. Here, each species is labeled and readers can determine the percent shrinkage by using the number line or by comparing the difference in area between the shaded regions in the drawing of the seaweed. For each species, the larger outline represents the size of a seaweed when it is initially collected, and the smaller, colored outline represents the algae after it has been dried, scaled down to its measured percent decrease. In this plot, I played around with the idea that color could convey complexity, and each color of the seaweeds that are drawn represents the family that the it belongs to (red - Rhodophyta, brown - Phaeophyta, and green - Chlorophyta). I also added in an appealing, professional font, which offers nothing other than a refreshing break from the default R font.</p>
<blockquote class="blockquote">
<p><span class="small-text"><strong>A note about color:</strong> One in twenty people has some form of color blindness. To increase accessibility in my visualizations, I used David Nichols’s <a href="https://davidmathlogic.com/colorblind/#%23D81B60-%23FFBF00-%2354662C-%23009BB0">Coloring for Colorblindness</a> to choose a palette for those who see colors differently. I also used colors from the <a href="">calecopal palette</a> designed by the amazing An Bui, <a href="https://www.heililowman.com/">Heili Lowman</a>, Ana Sofia Guerra, and <a href="https://anamtk.weebly.com/">Ana Miller-ter Kuile</a></span></p>
</blockquote>
</section>
<section id="concluding-a-story" class="level2">
<h2 class="anchored" data-anchor-id="concluding-a-story">Concluding a story</h2>
<p>Through this course, I’ve become more intentional with the elements I include in my visualizations, and I’ve gained new tools to tell the story of my data. Most of my experience with data visualization has been with those black and white figures you find in scientific journals; the ones that are either devoid of complexity or packed with so much information that it’s hard to draw anything meaningful from there. By leaning into the artistic side of data visualization, we can tell whole stories with a few lines of code and some thoughtful design. I’ve always liked the intersection of art and science. Art speaks to us in a language that requires no translation, and it has the potential to increase access to the subject material. I now see that data science sits at the intersection of art and science. In the future, I hope to lean into the artistic side of data science to help science reach a wider audience.</p>
</section>
<section id="figure-code" class="level2">
<h2 class="anchored" data-anchor-id="figure-code">Figure Code</h2>
<blockquote class="blockquote">
<p><span class="small-text">Below is the code used to render each of the plots. Some drawings and labels were created using the Adobe Suite. The shrinkage plot was created using data pulled manually from the ggpredict function for the herbarium models(x=3).</span></p>
</blockquote>
<section id="setting-up-the-models" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-the-models">Setting up the models!</h3>
<div class="cell">
<details>
<summary>Show me the code!</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                                    Setup                                 ----</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................load libraries.........................</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjlabelled)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(waffle)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................load fonts.........................</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Marcellus"</span>, <span class="at">family =</span> <span class="st">"marc"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Josefin Sans"</span>, <span class="at">family =</span> <span class="st">"josefin"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Lexend"</span>, <span class="at">family =</span> <span class="st">"lex"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................reading in data.........................</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>height_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_height.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>width_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_width.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>perimeter_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_perimeter.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>surf_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_surf.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>tdmc_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_tdmc.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>thickness_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_thickness.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>volume_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_volume.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot theme</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot.background =</span> <span class="fu">element_blank</span>()))</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># abline color</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>ref_line_col <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># model prediction color</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>model_col <span class="ot">&lt;-</span> <span class="st">"darkblue"</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................model making.........................</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>height_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(height_i <span class="sc">~</span> height_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> height_all)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(height_reg_ir)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>height_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(height_i <span class="sc">~</span> height_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> height_all)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(height_reg_ir_nospecies)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>width_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(width_i <span class="sc">~</span> width_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> width_all)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>width_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(width_i <span class="sc">~</span> width_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> width_all)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(width_reg_ir_nospecies)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>perimeter_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(per_i <span class="sc">~</span> per_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> perimeter_all)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(perimeter_reg_ir)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>perimeter_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(per_i <span class="sc">~</span> per_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> perimeter_all)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(perimeter_reg_ir_nospecies)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>surf_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(surf_i <span class="sc">~</span> surf_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> surf_all)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(surf_reg_ir)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>surf_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(surf_i <span class="sc">~</span> surf_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> surf_all)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(surf_reg_ir_nospecies)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>tdmc_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(weight_i <span class="sc">~</span> weight_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> tdmc_all)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tdmc_reg_ir)</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>tdmc_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(weight_i <span class="sc">~</span> weight_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> tdmc_all)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tdmc_reg_ir_nospecies)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>thick_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(thick_i <span class="sc">~</span> thick_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> thickness_all)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thick_reg_ir)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>thick_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(thick_i <span class="sc">~</span> thick_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> thickness_all)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thick_reg_ir_nospecies)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>volume_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(vol_i <span class="sc">~</span> vol_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> volume_all)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(volume_reg_ir)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>volume_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(vol_i <span class="sc">~</span> vol_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> volume_all)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(volume_reg_ir_nospecies)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................save models as predictions.........................</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>height_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(height_reg_ir_nospecies, <span class="at">terms =</span> <span class="st">"height_r[0:45]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"height"</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>width_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(width_reg_ir_nospecies, <span class="at">terms =</span> <span class="st">"width_r[0:30]"</span>) <span class="sc">%&gt;%</span> <span class="co">#max width = 24</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"width"</span>) </span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>perimeter_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(perimeter_reg_ir, <span class="at">terms =</span> <span class="st">"per_r[0:375]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"perimeter"</span>)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>perimeter_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(perimeter_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"per_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>surf_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(surf_reg_ir, <span class="at">terms =</span> <span class="st">"surf_r[0:430]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"surface area"</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>surf_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(surf_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"surf_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>tdmc_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(tdmc_reg_ir, <span class="at">terms =</span> <span class="st">"weight_r[0:29050]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"thallus dry matter content"</span>)</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>tdmc_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(tdmc_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"weight_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>thick_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(thick_reg_ir_nospecies, <span class="at">terms =</span> <span class="st">"thick_r[0:2]"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"thickness"</span>)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>volume_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(volume_reg_ir, <span class="at">terms =</span> <span class="st">"vol_r[0:30]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"volume"</span>)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>volume_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(volume_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"vol_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="co">#create a combined dataframe with all predictions</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>init_rehy_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(surf_ir_predictions, <span class="co"># rbind stacks data frames on top of each other if they have the same columns</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>                      perimeter_ir_predictions, </span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>                      tdmc_ir_predictions, </span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>                      height_ir_predictions, </span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>                      width_ir_predictions, </span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>                      thick_ir_predictions, </span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>                      volume_ir_predictions) <span class="sc">%&gt;%</span> </span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> init_rehy_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-highlighting-11-relationships" class="level3">
<h3 class="anchored" data-anchor-id="plot-highlighting-11-relationships">Plot highlighting 1:1 relationships</h3>
<div class="cell">
<details>
<summary>Show me the code!</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................assigning opacity values (manually).........................</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>init23 <span class="ot">&lt;-</span> init[init<span class="sc">$</span>trait <span class="sc">!=</span> <span class="st">"thallus dry matter content"</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>init23<span class="sc">$</span>opacity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"height"</span>, <span class="dv">3</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"width"</span>, <span class="dv">3</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"perimeter"</span>, <span class="fl">0.1</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"surface area"</span>, <span class="fl">0.1</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"thickness"</span>, <span class="fl">0.1</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                                         <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"volume"</span>, <span class="fl">0.1</span>, <span class="cn">NA</span> ))))))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................manually offsetting the heigh - width labels.........................</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> init23 <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x <span class="sc">==</span> <span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(trait),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">nudge_y =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>           trait <span class="sc">==</span> <span class="st">"height"</span> <span class="sc">~</span> <span class="fl">0.7</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>           trait <span class="sc">==</span> <span class="st">"width"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>           <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................titles and palettes.........................</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="st">"Two predictive trait models based on rehydrated values closely follow a 1:1 relationship"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>subtitle <span class="ot">&lt;-</span> <span class="st">"The traits that follow this pattern are Height and Width"</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>trait_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"surface area"</span> <span class="ot">=</span> <span class="st">"#ffbf00"</span>, </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"perimeter"</span> <span class="ot">=</span> <span class="st">"#be8333"</span>, </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># "thallus dry matter content" = "#54662c", </span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"height"</span> <span class="ot">=</span> <span class="st">"#009bb0"</span>, </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"width"</span> <span class="ot">=</span> <span class="st">"#124c54"</span>, </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"thickness"</span> <span class="ot">=</span> <span class="st">"#368000"</span>, </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"volume"</span> <span class="ot">=</span> <span class="st">"#b4450e"</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................plotting.........................</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a> plot_ir_1s <span class="ot">&lt;-</span> init23 <span class="sc">%&gt;%</span> </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, predicted, <span class="at">color =</span> trait, <span class="at">alpha =</span> opacity))<span class="sc">+</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="co"># adding a dashed grey 1:1 reference line</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_ribbon(aes(fill = trait, # adding 95% CI (uncomment this if you want to see it)</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymin = conf.low,</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymax = conf.high),</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             alpha = 0.2) +</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># plotting model predictions</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Rehydrated Value"</span>, <span class="co"># renaming the axes</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Initial Value"</span>, </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> title,</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> subtitle) <span class="sc">+</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> trait_palette)<span class="sc">+</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> init23 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">==</span> <span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(trait)),</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">alpha =</span> opacity), </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.1</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> label_df<span class="sc">$</span>nudge_y,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"lex"</span>, </span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">#alpha = opacity</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fontface = "light"</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">7.2</span>), </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>, </span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">17</span>, </span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>                              <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="fl">0.3</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="cn">NA</span>))</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a> plot_ir_1s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-highlighting-deviations-from-a-11-relationship" class="level3">
<h3 class="anchored" data-anchor-id="plot-highlighting-deviations-from-a-11-relationship">Plot highlighting deviations from a 1:1 relationship</h3>
<div class="cell">
<details>
<summary>Show me the code!</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................assigning opacity values (manually).........................</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> init_rehy_df </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>init2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(init) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="fu">as.factor</span>(trait))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>init2 <span class="ot">&lt;-</span> init[init<span class="sc">$</span>trait <span class="sc">!=</span> <span class="st">"thallus dry matter content"</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>init2<span class="sc">$</span>opacity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"height"</span>, <span class="dv">1</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"width"</span>, <span class="dv">1</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"perimeter"</span>, <span class="dv">3</span>, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"surface area"</span>, <span class="dv">3</span>, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"thickness"</span>, <span class="dv">1</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                                                         <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"volume"</span>, <span class="dv">3</span>, <span class="cn">NA</span> ))))))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................titles and palettes.........................</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="st">"Predictive models based on rehydrated measurements vary by trait"</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>subtitle <span class="ot">&lt;-</span> <span class="st">"The traits that deviate the most are Perimeter, Volume, and Surface Area"</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>trait_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"surface area"</span> <span class="ot">=</span> <span class="st">"#ffbf00"</span>, </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"perimeter"</span> <span class="ot">=</span> <span class="st">"#be8333"</span>, </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># "thallus dry matter content" = "#54662c", </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"height"</span> <span class="ot">=</span> <span class="st">"#009bb0"</span>, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"width"</span> <span class="ot">=</span> <span class="st">"#124c54"</span>, </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"thickness"</span> <span class="ot">=</span> <span class="st">"#368000"</span>, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"volume"</span> <span class="ot">=</span> <span class="st">"#b4450e"</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................plotting.........................</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>plot_ir_deviants <span class="ot">&lt;-</span> init2 <span class="sc">%&gt;%</span> </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, predicted, <span class="at">color =</span> trait, <span class="at">alpha =</span> opacity))<span class="sc">+</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="co"># adding a dashed grey 1:1 reference line</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_ribbon(aes(fill = trait, # adding 95% CI (uncomment this if you want to see it)</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymin = conf.low,</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymax = conf.high),</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             alpha = 0.2) +</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="co"># plotting model predictions</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Rehydrated Value"</span>, <span class="co"># renaming the axes</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Initial Value"</span>, </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> title,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> subtitle) <span class="sc">+</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> trait_palette)<span class="sc">+</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> init2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">==</span> <span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(trait)),</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.1</span>, </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"lex"</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fontface = "light"</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">7.2</span>), </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>, </span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">17</span>, </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>                              <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.3</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="cn">NA</span>))</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>plot_ir_deviants</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "visualizing the past, present, and predictions"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> kelp-pressing.jpg</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> Learning the art of data science</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    echo: true</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">    eval: true</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show me the code!"</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#183d3d"</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span><span class="co"> </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - lightbox</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="an">freeze:</span><span class="co"> auto</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 3/13/25</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a> <span class="at">&gt; **TL;DR** I recently took my first data visualization class. Until now, I'd only known data visualization as something sterile-centered around numbers and packed with as many data points as a journal would realistically publish. I thought good data visualizations were only found in research papers, but I've realized that good data visualizations (often the best) live inside a world that is just as much art as it is science. Below is my first crack at using the art of data visualization to conceptualize some of my seaweed science.</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Killing two birds with one class </span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>I'm probably lying to myself when I say I don't know how it happens, but I seem to always inundate myself with projects until my mind is waterlogged. I'm constantly behind, so I'll always jump at an opportunity to kill two birds with one stone-or, in this case, one class. I recently took Environmental Data Science 240: Data Visualization at the Bren School of Environmental Science and Management, taught by <span class="co">[</span><span class="ot">Sam Shanny-Csik</span><span class="co">](https://samanthacsik.github.io/)</span> and teaching assistants <span class="co">[</span><span class="ot">Annie Adams</span><span class="co">](https://annieradams.github.io/)</span> and Sloane Stephenson. The stars could not have aligned better because not only was this an opportunity to learn from a data science icon like Sam (whose open source guides taught me data science principles and website design long before I was her student), but also because it gave me an opportunity to create figures for a paper that I've had in the works for over a year. </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## Some context about FUNctional traits</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>Before I dive into my data visualization process, here's some context about the paper I'm creating these data visualizations for. My paper is an extension of a project called <span class="co">[</span><span class="ot">Past, Present, Predictions: functional approaches to link species to ecosystem function</span><span class="co">](https://haydenvega.github.io/research/2023-pastpresentpredictions/)</span>.It builds off the PhD thesis of one of my mentors and another data science icon, <span class="co">[</span><span class="ot">An Bui</span><span class="co">](https://an-bui.com/)</span>. My project explores the idea that we can leverage the large collections of seaweeds that are preserved by museums and universities into long-term data about kelp forests. Many museums and universities have collections of seaweeds that span hundreds of specimens, species, and even years. These collections are used to studying the anatomy of seaweeds, but my project aims to study how these seaweeds functioned within their kelp forest. We can get data about a seaweed's function by measuring its characteristics like height, width, volume, or thickness. Measurements like these are called **functional traits** and they can give us clues as to how a seaweed contributed to kelp forest functions/characteristics such as photosynthetic rates, wave reduction, and overall mass of seaweed. </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="al">![A diagram showing how height and width (common functional traits) are measured on a simulated seaweed specimen](hw-diagram.png)</span> </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>What's unique about <span class="kw">&lt;i&gt;</span>preserved<span class="kw">&lt;/i&gt;</span> seaweed is that they are a snapshot in time, and we can use them as a window to the past of kelp forest function. Using preserved seaweed, we can observe how a kelp forest functioned at a point in time that predates any data we currently have. This is important because we can use our understanding of the past to predict how kelp forests will function in an uncertain future. But using preserved seaweed also presents a unique challenge when using functional traits. </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="al">![One of the oldest pressed seaweeds at the UCSB Herbarium. Collected in 1902 by Mary S. Snyder, this specimen is over one hundred years old!](kelp-pressing.jpg)</span> </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>Universities and museums preserve seaweed by flattening specimens and slowly drying them out. During the process, the seaweeds shrink. This poses a challenge to a functional trait approach because our measurements are now biased by the preservation process. A seaweed with a height of 16 inches when it was initially collected may measure 8 inches after it is dried. **My project seeks to overcome this bias by creating models that use the functional traits of a preserved seaweed to predict the functional traits of that same seaweed before it was preserved.** And I will be visualizing these models in my plots below! </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## The plot thickens</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>I started this process with two concrete goals for my visualizations: to show that our models vary by trait and to show that our models vary by species. But as I learned and thought more about the purpose of data visualization, I added a third goal: tell a story. </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="al">![An example of an early visualization showing all the different models for each treatment. Note that this plot is hard to read and lacks structure and a clear message](ugly-viz.png)</span> </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>I wanted to show linear models, so I started with a line graph, just two axis and a line. This was perfect for showing the models, but there wasn't a story there. So I turned to embellishments like titles, labels, colors, and typography to add some narrative to my plots. I had an easy time creating titles and labels because I understood their purpose within a narrative. I had a harder time with elements like color and typography. I never even considered them as elements of a story. Even from a purely aesthetic perspective, I didn't understand them well. I realized I had been neglecting these components not only in my data visualizations, but also in my everyday life. This exercise in data visualization soon became an exercise in intentional design. </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>::: {layout="[<span class="co">[</span><span class="ot">1</span><span class="co">]</span>, <span class="co">[</span><span class="ot">1</span><span class="co">]</span>, <span class="co">[</span><span class="ot">1</span><span class="co">]</span>]"} </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="al">![](algae shrink1.png)</span>{group="finalviz" description="A diagram quantifying extent to which a seaweed shrinks during the preservation process and that it varies by species."}</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="al">![](plot_ir_1s.png)</span>{group="finalviz" description="A line graph displaying linear models that predict initial functional trait measurements based on rehydrated preserved seaweed. The models for height and width are highlighted to show that they closely follow a 1:1 relationship between initial and rehydrated measurements"} </span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="al">![](plot_ir_deviants.png)</span>{group="finalviz" description="A line graph displaying linear models that predict initial functional trait measurements based on rehydrated preserved seaweed. The models for perimeter, volume, and surface area are highlighted to show that they do not follow a 1:1 relationship between initial and rehydrated measurements. This suggests that predictive models are unique to each trait."} </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>When thinking about the design of my plots, I started with the titles and subtitles. My goal was that they would give the reader the main takeaways from the plot. Data visualization is a complex language in itself. Putting my main takeaways in the titles helps the reader walk away with the main idea without even having to decipher the plot. As a result, my titles are broad and say something about the nature of the relationships shown (vary by species or follow a 1:1 line). Further specificity is available for readers in the plot. There I targeted multiple visual hierarchies to help the reader interpret the data from different angles, and I used embellishments like color and drawings to give the readers access to further complexity. Basic themes were used to minimize non-data ink and to draw attention to just the data being shown. An example where these elements were incorporated is in the shrinkage plot. </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="al">![](algae shrink1.png)</span>{group="finalviz" description="My favorite viz and a diagram quantifying extent to which a seaweed shrinks during the preservation process and that it varies by species."} </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>In this plot, the main takeaway is that the preservation process changes each species differently, suggesting that some models may need to be species-dependent. Here, each species is labeled and readers can determine the percent shrinkage by using the number line or by comparing the difference in area between the shaded regions in the drawing of the seaweed. For each species, the larger outline represents the size of a seaweed when it is initially collected, and the smaller, colored outline represents the algae after it has been dried, scaled down to its measured percent decrease. In this plot, I played around with the idea that color could convey complexity, and each color of the seaweeds that are drawn represents the family that the it belongs to (red - Rhodophyta, brown - Phaeophyta, and green - Chlorophyta). I also added in an appealing, professional font, which offers nothing other than a refreshing break from the default R font. </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span><span class="co">[</span><span class="ot">**A note about color:** One in twenty people has some form of color blindness. To increase accessibility in my visualizations, I used David Nichols's [Coloring for Colorblindness](https://davidmathlogic.com/colorblind/#%23D81B60-%23FFBF00-%2354662C-%23009BB0) to choose a palette for those who see colors differently. I also used colors from the [calecopal palette]() designed by the amazing An Bui, [Heili Lowman](https://www.heililowman.com/), Ana Sofia Guerra, and [Ana Miller-ter Kuile](https://anamtk.weebly.com/)</span><span class="co">]</span><span class="at">{.small-text} </span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## Concluding a story </span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>Through this course, I've become more intentional with the elements I include in my visualizations, and I've gained new tools to tell the story of my data. Most of my experience with data visualization has been with those black and white figures you find in scientific journals; the ones that are either devoid of complexity or packed with so much information that it's hard to draw anything meaningful from there. By leaning into the artistic side of data visualization, we can tell whole stories with a few lines of code and some thoughtful design. I've always liked the intersection of art and science. Art speaks to us in a language that requires no translation, and it has the potential to increase access to the subject material. I now see that data science sits at the intersection of art and science. In the future, I hope to lean into the artistic side of data science to help science reach a wider audience. </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="fu">## Figure Code </span></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span><span class="co">[</span><span class="ot">Below is the code used to render each of the plots. Some drawings and labels were created using the Adobe Suite. The shrinkage plot was created using data pulled manually from the ggpredict function for the herbarium models(x=3).</span><span class="co">]</span><span class="at">{.small-text}</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setting up the models!</span></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a><span class="do">##                                    Setup                                 ----</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a><span class="do">##~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................load libraries.........................</span></span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjlabelled)</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(waffle)</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext)</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................load fonts.........................</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Marcellus"</span>, <span class="at">family =</span> <span class="st">"marc"</span>)</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Josefin Sans"</span>, <span class="at">family =</span> <span class="st">"josefin"</span>)</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name =</span> <span class="st">"Lexend"</span>, <span class="at">family =</span> <span class="st">"lex"</span>)</span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................reading in data.........................</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>height_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_height.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>width_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_width.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>perimeter_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_perimeter.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>surf_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_surf.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>tdmc_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_tdmc.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>thickness_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_thickness.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>volume_all <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"final_volume.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(specimen_id, <span class="at">delim =</span> <span class="st">"-"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"site"</span>, <span class="st">"individual"</span>, <span class="st">"specimen"</span>), <span class="at">cols_remove=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"individual_id"</span>, date<span class="sc">:</span>individual, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot theme</span></span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot.background =</span> <span class="fu">element_blank</span>()))</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a><span class="co"># abline color</span></span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>ref_line_col <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a><span class="co"># model prediction color</span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>model_col <span class="ot">&lt;-</span> <span class="st">"darkblue"</span></span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................model making.........................</span></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>height_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(height_i <span class="sc">~</span> height_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> height_all)</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(height_reg_ir)</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>height_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(height_i <span class="sc">~</span> height_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> height_all)</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(height_reg_ir_nospecies)</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a>width_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(width_i <span class="sc">~</span> width_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> width_all)</span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>width_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(width_i <span class="sc">~</span> width_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> width_all)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(width_reg_ir_nospecies)</span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>perimeter_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(per_i <span class="sc">~</span> per_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> perimeter_all)</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(perimeter_reg_ir)</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>perimeter_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(per_i <span class="sc">~</span> per_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> perimeter_all)</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(perimeter_reg_ir_nospecies)</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>surf_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(surf_i <span class="sc">~</span> surf_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> surf_all)</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(surf_reg_ir)</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>surf_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(surf_i <span class="sc">~</span> surf_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> surf_all)</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(surf_reg_ir_nospecies)</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>tdmc_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(weight_i <span class="sc">~</span> weight_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> tdmc_all)</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tdmc_reg_ir)</span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>tdmc_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(weight_i <span class="sc">~</span> weight_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> tdmc_all)</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tdmc_reg_ir_nospecies)</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>thick_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(thick_i <span class="sc">~</span> thick_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> thickness_all)</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thick_reg_ir)</span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>thick_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(thick_i <span class="sc">~</span> thick_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> thickness_all)</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(thick_reg_ir_nospecies)</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>volume_reg_ir <span class="ot">&lt;-</span> <span class="fu">lmer</span>(vol_i <span class="sc">~</span> vol_r <span class="sc">*</span> species <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> volume_all)</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(volume_reg_ir)</span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>volume_reg_ir_nospecies <span class="ot">&lt;-</span> <span class="fu">lmer</span>(vol_i <span class="sc">~</span> vol_r <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> individual_id), <span class="at">data =</span> volume_all)</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(volume_reg_ir_nospecies)</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................save models as predictions.........................</span></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>height_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(height_reg_ir_nospecies, <span class="at">terms =</span> <span class="st">"height_r[0:45]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"height"</span>)</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>width_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(width_reg_ir_nospecies, <span class="at">terms =</span> <span class="st">"width_r[0:30]"</span>) <span class="sc">%&gt;%</span> <span class="co">#max width = 24</span></span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"width"</span>) </span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>perimeter_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(perimeter_reg_ir, <span class="at">terms =</span> <span class="st">"per_r[0:375]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"perimeter"</span>)</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>perimeter_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(perimeter_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"per_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>surf_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(surf_reg_ir, <span class="at">terms =</span> <span class="st">"surf_r[0:430]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"surface area"</span>)</span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>surf_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(surf_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"surf_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>tdmc_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(tdmc_reg_ir, <span class="at">terms =</span> <span class="st">"weight_r[0:29050]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"thallus dry matter content"</span>)</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>tdmc_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(tdmc_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"weight_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>thick_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(thick_reg_ir_nospecies, <span class="at">terms =</span> <span class="st">"thick_r[0:2]"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"thickness"</span>)</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>volume_ir_predictions <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(volume_reg_ir, <span class="at">terms =</span> <span class="st">"vol_r[0:30]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="st">"volume"</span>)</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>volume_ir_predictions_species <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(volume_reg_ir, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"vol_r"</span>, <span class="st">"species"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> group)</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a><span class="co">#create a combined dataframe with all predictions</span></span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>init_rehy_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(surf_ir_predictions, <span class="co"># rbind stacks data frames on top of each other if they have the same columns</span></span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>                      perimeter_ir_predictions, </span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>                      tdmc_ir_predictions, </span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>                      height_ir_predictions, </span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>                      width_ir_predictions, </span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>                      thick_ir_predictions, </span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>                      volume_ir_predictions) <span class="sc">%&gt;%</span> </span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> init_rehy_df</span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot highlighting 1:1 relationships</span></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................assigning opacity values (manually).........................</span></span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>init23 <span class="ot">&lt;-</span> init[init<span class="sc">$</span>trait <span class="sc">!=</span> <span class="st">"thallus dry matter content"</span>]</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>init23<span class="sc">$</span>opacity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"height"</span>, <span class="dv">3</span>,</span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"width"</span>, <span class="dv">3</span>,</span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"perimeter"</span>, <span class="fl">0.1</span>, </span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"surface area"</span>, <span class="fl">0.1</span>, </span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"thickness"</span>, <span class="fl">0.1</span>, </span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>                                                         <span class="fu">ifelse</span>(init23<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"volume"</span>, <span class="fl">0.1</span>, <span class="cn">NA</span> ))))))</span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................manually offsetting the heigh - width labels.........................</span></span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>label_df <span class="ot">&lt;-</span> init23 <span class="sc">%&gt;%</span> </span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(x <span class="sc">==</span> <span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(trait),</span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>         <span class="at">nudge_y =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>           trait <span class="sc">==</span> <span class="st">"height"</span> <span class="sc">~</span> <span class="fl">0.7</span>,</span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>           trait <span class="sc">==</span> <span class="st">"width"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a>           <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................titles and palettes.........................</span></span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="st">"Two predictive trait models based on rehydrated values closely follow a 1:1 relationship"</span></span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a>subtitle <span class="ot">&lt;-</span> <span class="st">"The traits that follow this pattern are Height and Width"</span></span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>trait_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"surface area"</span> <span class="ot">=</span> <span class="st">"#ffbf00"</span>, </span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"perimeter"</span> <span class="ot">=</span> <span class="st">"#be8333"</span>, </span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># "thallus dry matter content" = "#54662c", </span></span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"height"</span> <span class="ot">=</span> <span class="st">"#009bb0"</span>, </span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"width"</span> <span class="ot">=</span> <span class="st">"#124c54"</span>, </span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"thickness"</span> <span class="ot">=</span> <span class="st">"#368000"</span>, </span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"volume"</span> <span class="ot">=</span> <span class="st">"#b4450e"</span>)</span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................plotting.........................</span></span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a> plot_ir_1s <span class="ot">&lt;-</span> init23 <span class="sc">%&gt;%</span> </span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, predicted, <span class="at">color =</span> trait, <span class="at">alpha =</span> opacity))<span class="sc">+</span></span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="co"># adding a dashed grey 1:1 reference line</span></span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_ribbon(aes(fill = trait, # adding 95% CI (uncomment this if you want to see it)</span></span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymin = conf.low,</span></span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymax = conf.high),</span></span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             alpha = 0.2) +</span></span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># plotting model predictions</span></span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Rehydrated Value"</span>, <span class="co"># renaming the axes</span></span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Initial Value"</span>, </span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> title,</span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> subtitle) <span class="sc">+</span></span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> trait_palette)<span class="sc">+</span></span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> init23 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">==</span> <span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(trait)),</span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">alpha =</span> opacity), </span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.1</span>,</span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> label_df<span class="sc">$</span>nudge_y,</span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"lex"</span>, </span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>    <span class="co">#alpha = opacity</span></span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fontface = "light"</span></span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">7.2</span>), </span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>, </span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">17</span>, </span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-316"><a href="#cb4-316" aria-hidden="true" tabindex="-1"></a>                              <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="fl">0.3</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb4-317"><a href="#cb4-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb4-318"><a href="#cb4-318" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb4-319"><a href="#cb4-319" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-320"><a href="#cb4-320" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb4-321"><a href="#cb4-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb4-322"><a href="#cb4-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="cn">NA</span>))</span>
<span id="cb4-323"><a href="#cb4-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-324"><a href="#cb4-324" aria-hidden="true" tabindex="-1"></a> plot_ir_1s</span>
<span id="cb4-325"><a href="#cb4-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-326"><a href="#cb4-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-327"><a href="#cb4-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot highlighting deviations from a 1:1 relationship</span></span>
<span id="cb4-328"><a href="#cb4-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb4-329"><a href="#cb4-329" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................assigning opacity values (manually).........................</span></span>
<span id="cb4-330"><a href="#cb4-330" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb4-331"><a href="#cb4-331" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> init_rehy_df </span>
<span id="cb4-332"><a href="#cb4-332" aria-hidden="true" tabindex="-1"></a>init2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(init) <span class="sc">%&gt;%</span> </span>
<span id="cb4-333"><a href="#cb4-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trait =</span> <span class="fu">as.factor</span>(trait))</span>
<span id="cb4-334"><a href="#cb4-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-335"><a href="#cb4-335" aria-hidden="true" tabindex="-1"></a>init2 <span class="ot">&lt;-</span> init[init<span class="sc">$</span>trait <span class="sc">!=</span> <span class="st">"thallus dry matter content"</span>]</span>
<span id="cb4-336"><a href="#cb4-336" aria-hidden="true" tabindex="-1"></a>init2<span class="sc">$</span>opacity <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"height"</span>, <span class="dv">1</span>,</span>
<span id="cb4-337"><a href="#cb4-337" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"width"</span>, <span class="dv">1</span>,</span>
<span id="cb4-338"><a href="#cb4-338" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"perimeter"</span>, <span class="dv">3</span>, </span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"surface area"</span>, <span class="dv">3</span>, </span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"thickness"</span>, <span class="dv">1</span>, </span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>                                                         <span class="fu">ifelse</span>(init2<span class="sc">$</span>trait <span class="sc">==</span> <span class="st">"volume"</span>, <span class="dv">3</span>, <span class="cn">NA</span> ))))))</span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................titles and palettes.........................</span></span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true" tabindex="-1"></a>title <span class="ot">&lt;-</span> <span class="st">"Predictive models based on rehydrated measurements vary by trait"</span></span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true" tabindex="-1"></a>subtitle <span class="ot">&lt;-</span> <span class="st">"The traits that deviate the most are Perimeter, Volume, and Surface Area"</span></span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true" tabindex="-1"></a>trait_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"surface area"</span> <span class="ot">=</span> <span class="st">"#ffbf00"</span>, </span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"perimeter"</span> <span class="ot">=</span> <span class="st">"#be8333"</span>, </span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># "thallus dry matter content" = "#54662c", </span></span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"height"</span> <span class="ot">=</span> <span class="st">"#009bb0"</span>, </span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"width"</span> <span class="ot">=</span> <span class="st">"#124c54"</span>, </span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"thickness"</span> <span class="ot">=</span> <span class="st">"#368000"</span>, </span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"volume"</span> <span class="ot">=</span> <span class="st">"#b4450e"</span>)</span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................plotting.........................</span></span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true" tabindex="-1"></a>plot_ir_deviants <span class="ot">&lt;-</span> init2 <span class="sc">%&gt;%</span> </span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, predicted, <span class="at">color =</span> trait, <span class="at">alpha =</span> opacity))<span class="sc">+</span></span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="co"># adding a dashed grey 1:1 reference line</span></span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"grey"</span>,</span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_ribbon(aes(fill = trait, # adding 95% CI (uncomment this if you want to see it)</span></span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymin = conf.low,</span></span>
<span id="cb4-368"><a href="#cb4-368" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                 ymax = conf.high),</span></span>
<span id="cb4-369"><a href="#cb4-369" aria-hidden="true" tabindex="-1"></a>  <span class="co">#             alpha = 0.2) +</span></span>
<span id="cb4-370"><a href="#cb4-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb4-371"><a href="#cb4-371" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="co"># plotting model predictions</span></span>
<span id="cb4-372"><a href="#cb4-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Rehydrated Value"</span>, <span class="co"># renaming the axes</span></span>
<span id="cb4-373"><a href="#cb4-373" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted Initial Value"</span>, </span>
<span id="cb4-374"><a href="#cb4-374" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> title,</span>
<span id="cb4-375"><a href="#cb4-375" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> subtitle) <span class="sc">+</span></span>
<span id="cb4-376"><a href="#cb4-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> trait_palette)<span class="sc">+</span></span>
<span id="cb4-377"><a href="#cb4-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb4-378"><a href="#cb4-378" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb4-379"><a href="#cb4-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb4-380"><a href="#cb4-380" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> init2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">==</span> <span class="fu">max</span>(x)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">label =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(trait)),</span>
<span id="cb4-381"><a href="#cb4-381" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb4-382"><a href="#cb4-382" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">0</span>, </span>
<span id="cb4-383"><a href="#cb4-383" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="fl">0.1</span>, </span>
<span id="cb4-384"><a href="#cb4-384" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>, </span>
<span id="cb4-385"><a href="#cb4-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"lex"</span></span>
<span id="cb4-386"><a href="#cb4-386" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fontface = "light"</span></span>
<span id="cb4-387"><a href="#cb4-387" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb4-388"><a href="#cb4-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">7.2</span>), </span>
<span id="cb4-389"><a href="#cb4-389" aria-hidden="true" tabindex="-1"></a>                  <span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb4-390"><a href="#cb4-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb4-391"><a href="#cb4-391" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb4-392"><a href="#cb4-392" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb4-393"><a href="#cb4-393" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-394"><a href="#cb4-394" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb4-395"><a href="#cb4-395" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb4-396"><a href="#cb4-396" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb4-397"><a href="#cb4-397" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-398"><a href="#cb4-398" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)), </span>
<span id="cb4-399"><a href="#cb4-399" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>, </span>
<span id="cb4-400"><a href="#cb4-400" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">17</span>, </span>
<span id="cb4-401"><a href="#cb4-401" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-402"><a href="#cb4-402" aria-hidden="true" tabindex="-1"></a>                              <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.3</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)),</span>
<span id="cb4-403"><a href="#cb4-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"lex"</span>,</span>
<span id="cb4-404"><a href="#cb4-404" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb4-405"><a href="#cb4-405" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb4-406"><a href="#cb4-406" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="fl">0.5</span>, <span class="at">l =</span> <span class="dv">0</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb4-407"><a href="#cb4-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb4-408"><a href="#cb4-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="cn">NA</span>))</span>
<span id="cb4-409"><a href="#cb4-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-410"><a href="#cb4-410" aria-hidden="true" tabindex="-1"></a>plot_ir_deviants</span>
<span id="cb4-411"><a href="#cb4-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Hayden Vega</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/haydenvega">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/hayden-vega-6893a3207/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"loop":true,"closeEffect":"zoom","descPosition":"bottom","selector":".lightbox","openEffect":"zoom"});</script>



</body></html>